.TH deepsea 7
.SH NAME
DeepSea stage 2 \- a deeper insight
.SH DESCRIPTION
.B DeepSea Stage 2 (Configure)
is a Salt orchestration that configures the Salt pillar, generates Ceph keys and provisions monitoring.
.RE
.PD
.SH Preface
.PP
This stage applies the
.B policy.cfg
to the data collected in Stage 1 and saves the configuration in the Salt pillar.  The Salt pillar is a key value store.  For more information, see 
.UR https://docs.saltstack.com/en/latest/topics/tutorials/pillar.html.
.UE

.B Push proposals
.RS
The administrator must create a policy.cfg file.  See
.B deepsea-policy.cfg(5).
This file filters the collection of configuration fragments from Stage 1 and produces a suitable configuration for the Salt pillar.
.RE

.B Generate keys
.RS
Based on your role assignment, DeepSea generates authentication keys for each service.
.RE

.B Monitoring
.RS
DeepSea configures Prometheus and Grafana. See
.B deepsea-monitoring(7)
.RE


.SH EXAMPLE
salt-run state.orch ceph.stage.2
.PP
This command can also be used with
.B deepsea(1)
to give feedback during the process from the Salt event bus.  Salt orchestrations are unnervingly silent during execution and only report when complete.
.PP
deepsea salt-run state.orch ceph.stage.2
.PP
deepsea stage run ceph.stage.2

.SH AUTHOR
Joshua Schmid <jschmid@suse.com>
.SH SEE ALSO
.BR deepsea (1),
.BR deepsea (7),
.BR deepsea-commands (7),
.BR deepsea-stage-0 (7),
.BR deepsea-stage-1 (7),
.BR deepsea-stage-3 (7),
.BR deepsea-stage-4 (7),
.BR deepsea-stage-5 (7),
.BR deepsea-customization (7),
.BR deepsea-mines (7)
